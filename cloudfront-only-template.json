{
  "AWSTemplateFormatVersion": "2010-09-09",
  "Description": "CloudFront distribution for Constitution Learning Hub",
  "Resources": {
    "CloudFrontDistribution": {
      "Type": "AWS::CloudFront::Distribution",
      "Properties": {
        "DistributionConfig": {
          "Origins": [{
            "DomainName": "constitution-learning-hub-20251109-fresh.s3-website-us-east-1.amazonaws.com",
            "Id": "S3Origin",
            "CustomOriginConfig": {
              "HTTPPort": 80,
              "HTTPSPort": 443,
              "OriginProtocolPolicy": "http-only"
            }
          }],
          "Enabled": true,
          "DefaultRootObject": "index.html",
          "DefaultCacheBehavior": {
            "AllowedMethods": ["DELETE", "GET", "HEAD", "OPTIONS", "PATCH", "POST", "PUT"],
            "CachedMethods": ["GET", "HEAD"],
            "TargetOriginId": "S3Origin",
            "ForwardedValues": {
              "QueryString": false,
              "Cookies": {"Forward": "none"}
            },
            "ViewerProtocolPolicy": "redirect-to-https",
            "MinTTL": 0,
            "DefaultTTL": 86400,
            "MaxTTL": 31536000
          },
          "CustomErrorResponses": [{
            "ErrorCode": 404,
            "ResponseCode": 200,
            "ResponsePagePath": "/index.html"
          }, {
            "ErrorCode": 403,
            "ResponseCode": 200,
            "ResponsePagePath": "/index.html"
          }],
          "PriceClass": "PriceClass_All",
          "ViewerCertificate": {
            "CloudFrontDefaultCertificate": true
          },
          "Comment": "Constitution Learning Hub - Fresh Deployment"
        }
      }
    }
  },
  "Outputs": {
    "CloudFrontURL": {
      "Value": {"Fn::Sub": "https://${CloudFrontDistribution.DomainName}"},
      "Description": "CloudFront Distribution URL"
    },
    "DistributionId": {
      "Value": {"Ref": "CloudFrontDistribution"},
      "Description": "CloudFront Distribution ID"
    },
    "S3WebsiteURL": {
      "Value": "http://constitution-learning-hub-20251109-fresh.s3-website-us-east-1.amazonaws.com",
      "Description": "S3 Website URL"
    }
  }
}